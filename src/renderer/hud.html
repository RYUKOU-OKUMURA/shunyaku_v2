<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline';"
    />
    <title>Shunyaku HUD</title>
    <link rel="stylesheet" href="hud.css" />
  </head>
  <body>
    <!-- HUDメインコンテナ -->
    <div class="hud-container" id="hudContainer">
      <!-- HUDヘッダー（ドラッグ可能エリア） -->
      <div class="hud-header" id="hudHeader">
        <div class="hud-title">
          <span class="app-icon">🔄</span>
          <span class="app-name">Shunyaku</span>
        </div>
        <div class="hud-controls">
          <button class="control-btn pin-btn" id="pinBtn" title="固定モード切り替え">
            <span class="btn-icon" id="pinBtnIcon">📍</span>
          </button>
          <button class="control-btn minimize-btn" id="minimizeBtn" title="最小化">
            <span class="btn-icon">−</span>
          </button>
          <button class="control-btn close-btn" id="closeBtn" title="閉じる">
            <span class="btn-icon">×</span>
          </button>
        </div>
      </div>

      <!-- HUDメインコンテンツ -->
      <div class="hud-content" id="hudContent">
        <!-- 手動翻訳入力エリア（タスク2.5.1） -->
        <div class="manual-input-area" id="manualInputArea">
          <div class="input-section">
            <label class="input-label" for="manualTextInput">翻訳するテキストを入力:</label>
            <div class="input-container">
              <textarea
                class="manual-text-input"
                id="manualTextInput"
                placeholder="ここに翻訳したいテキストを入力してください..."
                rows="3"
                maxlength="5000"
              ></textarea>
              <div class="character-counter"><span id="characterCount">0</span> / 5000文字</div>
            </div>
          </div>

          <!-- 翻訳ボタンとオプション（タスク2.5.2） -->
          <div class="translate-section">
            <div class="translate-options">
              <select class="target-language-select" id="targetLanguageSelect">
                <option value="ja">日本語</option>
                <option value="en">English</option>
                <option value="zh">中文</option>
                <option value="ko">한국어</option>
                <option value="de">Deutsch</option>
                <option value="fr">Français</option>
                <option value="es">Español</option>
              </select>
            </div>
            <button class="translate-btn" id="translateBtn" disabled>
              <span class="btn-icon" id="translateBtnIcon">🔄</span>
              <span class="btn-text" id="translateBtnText">翻訳</span>
            </button>
          </div>
        </div>

        <!-- 翻訳結果表示エリア -->
        <div class="text-display-area" id="textDisplayArea" style="display: none">
          <div class="original-text-section">
            <div class="text-label">原文:</div>
            <div class="text-content" id="originalText">
              Hello World! This is a sample text for testing HUD display.
            </div>
          </div>

          <div class="translation-text-section">
            <div class="text-label">翻訳:</div>
            <div class="text-content" id="translatedText">
              こんにちは世界！これはHUD表示をテストするためのサンプルテキストです。
            </div>
          </div>

          <!-- ローディングインジケーター（改善版） -->
          <div class="loading-indicator" id="loadingIndicator" style="display: none">
            <div class="loading-spinner"></div>
            <div class="loading-text">処理中...</div>
          </div>

          <!-- エラー表示（拡張機能付き） -->
          <div class="error-display" id="errorDisplay" style="display: none">
            <div class="error-icon">⚠️</div>
            <div class="error-content">
              <div class="error-message" id="errorMessage">エラーメッセージ</div>
            </div>
          </div>

          <!-- OCR失敗時の手動入力フォールバック（タスク4.4.2） -->
          <div class="ocr-fallback-notice" id="ocrFallbackNotice" style="display: none">
            <div class="fallback-header">
              <span class="fallback-icon">✏️</span>
              <span class="fallback-title">テキスト認識失敗 - 手動入力モード</span>
            </div>
            <div class="fallback-message">
              画像からのテキスト認識に失敗しました。下記に直接テキストを入力してください。
            </div>
          </div>
        </div>

        <!-- 操作ボタンエリア -->
        <div class="action-buttons" id="actionButtons" style="display: none">
          <button class="action-btn copy-btn" id="copyBtn" title="翻訳文をコピー">
            <span class="btn-icon">📋</span>
            <span class="btn-text">コピー</span>
          </button>
          <button class="action-btn refresh-btn" id="refreshBtn" title="再翻訳">
            <span class="btn-icon">🔄</span>
            <span class="btn-text">再翻訳</span>
          </button>
          <button class="action-btn new-translation-btn" id="newTranslationBtn" title="新しい翻訳">
            <span class="btn-icon">➕</span>
            <span class="btn-text">新規翻訳</span>
          </button>
        </div>
      </div>

      <!-- ステータスバー -->
      <div class="hud-status" id="hudStatus">
        <div class="status-info">
          <span class="status-text" id="statusText">準備完了</span>
        </div>
        <div class="status-indicator">
          <!-- ネットワーク状態インジケーター（タスク4.4.3） -->
          <div class="network-indicator" id="networkIndicator" title="ネットワーク状態">
            <span class="network-icon" id="networkIcon">📶</span>
          </div>
          <div class="indicator-dot ready" id="statusIndicator"></div>
        </div>
      </div>

      <!-- オフライン通知（タスク4.4.3） -->
      <div class="offline-notice" id="offlineNotice" style="display: none">
        <div class="offline-header">
          <span class="offline-icon">📵</span>
          <span class="offline-title">オフライン状態</span>
        </div>
        <div class="offline-message">
          インターネット接続がありません。翻訳機能は利用できませんが、手動入力は可能です。
        </div>
        <div class="offline-actions">
          <button class="check-connection-btn" onclick="checkNetworkConnection()">
            <span>🔄</span> 接続確認
          </button>
        </div>
      </div>
    </div>

    <!-- HUD操作用のJavaScript -->
    <script src="hud.js"></script>
  </body>
</html>
